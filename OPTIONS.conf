#!/bin/bash

## Variables
## ATTENTION
## NETMASK just work for
## 255.255.255.0
## 255.255.0.0
## 255.0.0.0


#####################################################################
## GLOBAL NETWORK - settings
## for ALL servers with static IP
#####################################################################

## big network
NETWORK=10.0.0.0
NETMASK=255.0.0.0
BROADCAST=10.255.255.255
GATEWAY=10.0.0.254
## small network
#NETWORK=192.168.1.0
#NETMASK=255.255.255.0
#BROADCAST=192.168.1.255
#GATEWAY=192.168.1.254

## the name of your domain
DOMAIN_NAME=networkbox.net

## DNS #1
## IP of YOUR own DNS - server knowing all your servers
## for example: dhcp, tftp and so on
## for every name-server it has to be its OWN IP
## Example:
## name01 -> 10.0.0.1
## name02 -> 10.0.0.2
## big network
DNS_IP_LOCAL_NETWORK=10.0.0.1
## small network
#DNS_IP_LOCAL_NETWORK=192.168.1.1

## DNS #2 IP of your router/provider, do not leave it empty
## big network
DNS_IP_PROVIDER=10.0.0.254
## small network
#DNS_IP_PROVIDER=192.168.1.254

## DNS #3 IP out in the internet(google), do not leave it empty
DNS_IP_WWW=8.8.8.8


#####################################################################
## to istall server(s) NETWORK - settings
#####################################################################
## full networkbox: install.sh in this directory will install all
##                  all servers onto one maschine
##
## DNS:             install-hostname_and_static_ip.sh in directory
##                  hostname_static_ip
##                  &
##                  install-bind.sh in directory bind will install
##                  a static network interface and thd dns - server
##
## DHCP:            install-dhcp.sh in dhcp
##                  and so on ...
##
#####################################################################


#####################################################################
## HOSTNAME and NETWORK - INTERFACE
#####################################################################
HOSTNAME=name01
## big network
STATIC_IP=10.0.0.1
## small network
#STATIC_IP=192.168.1.1

## BRIDGE SETTINGS
## create a bridged interface br0 for lxd
## answer yes/no
## ATTENTION: machine has to reboot to get rid of dhcp-lease
##            of initial network interface
CREATE_BRIDGE=no
#
## LXD CONTAINER SETTINGS
## is this server a lxd container yes/no
## changes for containers:
## interface = eth0
## /etc/network/interfaces -> /etc/network/interfaces.d/50-cloud-init.cfg
## a LXD_SSH_SUDO_USER with password LXD_SSH_SUDO_USER_PASSWORD is created
## ssh login via network is enabled
LXD_CONTAINER=no
LXD_SSH_SUDO_USER=worker
LXD_SSH_SUDO_USER_PASSWORD="1234"

#####################################################################
## DNS - Server
#####################################################################
## nothing to do
## all settings, derived vom GLOBAL DNS and static NETWORK
##
## BUT ATTENTION:
##
## We use following names to identify services on servers:
## and they all point to HOSTNAME
## So, if you make changes, use your GIT,
## or change carefully after an standard installation
##
## name01		=>	name-server
##
## dhcp01		=>	dhcp-server
##
## nfs01,nfs02,nfs03,nfs04	=>	nfs-servers
##
## smb01,smb02,smb03	=>	samba-servers
##
## ldap01		=>	ldap-server
##
## cups01		=>	cups-server#
##
## laus01		=>	L(inux)A(utomatic)U(pdate)S(erver)
##
## apca01		=>	Apt-Cacher-Ng Server
##
## tftp01		=>	tftp-server
##
## mycloud01		=>	owncloud-server
##
## gateway		=>	default gateway
##
##
## if config files for zone lookup  and reverse lookup
## should be pulled from a git repository
## add repository  with db.$DOMAIN_NAME file and db.reverse
## may be a sensefull .gitignore file
## and a username with an e-mail address
DNS_GIT_REPOSITORY=
DNS_GIT_USER_NAME=
DNS_GIT_USER_EMAIL=


#####################################################################
## DHCP - Server
#####################################################################
## interfaces which offer dhcp - services
## will be dedected automatically, by choosing the active interface
## You will be asked, if more than on interface is active

## NEW EXAMPLE CONFIGURATION
## if new /etc/dhcpd.conf shall be created
## network - settings from section GLOBAL NETWORK - settings
## are used
## PLEASE set them!
## important other DHCP - settings 
## will be taken from DHCP - EXAMLPE Configuration below

## DHCP - EXAMLPE Configuration
## Options, if /etc/dhcpd.conf is generated by networkbox
## range for dynamic ip's, which have to be part of your NETWORK!
## big network
DHCP_MIN_RANGE=10.127.0.1
DHCP_MAX_RANGE=10.127.0.250
## small network
#DHCP_MIN_RANGE=192.168.1.200
#DHCP_MAX_RANGE=192.168.1.220

# hostname, ip and mac for 2 example - dhcp - clients
DHCP_HOST_1_HOSTNAME=r001pc01
## big network
DHCP_HOST_1_IP=10.0.1.1
## small network
#DHCP_HOST_1_IP=192.168.1.101
DHCP_HOST_1_MAC=00:00:00:00:00:01

DHCP_HOST_2_HOSTNAME=r002pc02
## big network
DHCP_HOST_2_IP=10.0.2.2
## small network
#DHCP_HOST_2_IP=192.168.1.121
DHCP_HOST_2_MAC=00:00:00:00:00:02

## WORKING CONFIGURATION FROM GIT
## if config file /etc/dhcpd.conf should be pulled from a git repository
## add repository, with dhcpd.conf file with an usefull .gitignore
## add username 
## add e-mail address
## you DO NOT need any other settings in OPTIONS.conf from above
DHCP_GIT_REPOSITORY=
DHCP_GIT_USER_NAME=
DHCP_GIT_USER_EMAIL=


#####################################################################
## TFTP - Server for PXE-Boot with PRESEED-Files
#####################################################################
# TFTP Server Name
## Standard tftp01 is set, 
## change if you want to use a second tftp server
## tftp01 will be replaced in start-screen for information and
## in preseed-files and grub.cfg (late_command string)
TFTP_SERVER_NAME=tftp01

## TFTP MENU PASSWD set in files:
## /var/lib/tftpboot/ubuntu-installer/menus/boot-screens/adtxt.cfg
## /var/lib/tftpboot/ubuntu-installer/menus/boot-screens/ubuntu1404.cfg
TFTP_MENU_PASSWD=123

## PRESEED (Debian Installer)
## config preseed files located in /var/lib/tftpboot/preseed
## preseed files are responsible for bootstrapping ubuntu-minimal

## USER-DATA (Ubuntu-Sever-Installer)
## config user-data yaml file located in webserver-root:ubuntu-server-installer

## name of admin (sudo for root) account for workstations
ADMIN_ACCOUNT_FULLNAME=Worker
ADMIN_ACCOUNT_NAME=worker
## cleartext password of the admin account
ADMIN_ACCOUNT_PASSWORD=1234

## location to store
## * ubuntu-server-iso
## * user-data (config file for installation)
## on tftp/http server
## we use apache2, so it is:
HTTP_ISO_YAML_DEST="/var/www/html/ubuntu-server-installer/"


#####################################################################
## NFS - Server
#####################################################################
## directory, in which NFS exports are for export collected
NFS_EXPORT_DIR=/export


#####################################################################
## LAUS - Server
#####################################################################
## laus server is created in directory:
## /opt/autoinstall
## and exported via NFS
## for networkbox the class NETWORKBOX is createted
## and filled with some basic scripts


#####################################################################
## LDAP - Server
#####################################################################
## setup of an LDAP - Server
## Information from:
## https://help.ubuntu.com/lts/serverguide/openldap-server.html#openldap-configuration

## Settings for the Real Time Configuration), or the cn=config method.
## Admin account to access cn=config database via ldap-browser from extern
LDAP_CN_CONFIG_ADMIN_NAME=admin
LDAP_CN_CONFIG_ADMIN_PASSWORD=1234

## a lot of schemas will be added to cn=config
## have a look at
## file ldap/cn_config/add-schemas_to_cn_config.sh
## to find out and reduce if necessary
## Reduction can always be done with a LDAP-browser later

## Settings for the ldap-tree, in which all data is stored
LDAP_DOMAIN_SUFFIX_FIRST=example
LDAP_DOMAIN_SUFFIX_SECOND=com
## will become dc=example,dc=com

## password for user admin in ldap-tree
LDAP_DOMAIN_ADMIN_PASSWORD=1234

## password for user ldapsync in ldap-tree
## ldapsync has read only access to the hole ldap tree to sync to backup ldap -servers
LDAP_SYNC_PASSWORD=4321

## set LDAP_IS_SLAVE_SERVER=yes, if a slave - server should be installed
## ldap01 will be used as PROVIDER:
## olcSyncrepl: {0}rid=1 provider=ldap://ldap01:389
LDAP_IS_SLAVE_SERVER=


#####################################################################
## LDAP - Client
#####################################################################
## setup of an LDAP - Client to connect to LDAP - Server above
## Information from:
## ldap -client will connect via user ldapread with read rights only
## instead admin user with full rights
## Advantage: now admin password on the client machine
## LDAP - Servers to connect to:
LDAP_CLIENT_LDAP_SERVERS="ldap01 ldap02"
## The distinguished name of the search base.
LDAP_CLIENT_DOMAIN_SUFFIX_FIRST=example
LDAP_CLIENT_DOMAIN_SUFFIX_SECOND=com
## will become dc=example,dc=com


#####################################################################
## KERBEROS
#####################################################################
## setup of an Kerberos Server using LDAP - Server as Database
## Information from:
## https://help.ubuntu.com/lts/serverguide/kerberos-ldap.html
## https://help.ubuntu.com/lts/serverguide/openldap-server.html#openldap-configuration
## REALM = domainnane from GLOBAL NETWORK - settings in upper cases
REALM_DOMAIN_NAME=$(echo "${DOMAIN_NAME}" | tr '[:lower:]' '[:upper:]')
## realm Container in dc=example,dc=com
REALM_CONTAINER=krb5Container
## will become cn=krb5Container,dc=example,dc=com
## which is the root of all kerberos objects
## Attention: the Kerberos Container has to be in cn= . dn= does not work
## the Ubuntu- Server Documentation IS NOT CORRECT!


#####################################################################
## SAMBA-3 SERVER
#####################################################################
## setup of a Samba-3 Server using LDAP - Server as Database
## Information from:
## https://help.ubuntu.com/lts/serverguide/samba-ldap.html
## ATTENTION:
## Set LDAP - Settings above!
## because the Samba - Server depends on it!
##
## Name of your NT/SAMBA Domain
SAMBA3_WORKGROUP=MYDOMAIN
## Name of your Primary Domain Controller
SAMBA3_NETBIOS_NAME=${HOSTNAME}
## Name/IP of your Server hosting LDAP - Backend
## for example: ldap01 for extern ldap-server or 127.0.0.1 for localhost
SAMBA3_LDAP_SERVER=127.0.0.1


#####################################################################
## SAMBA4 ENVIROMENT
#####################################################################
##
## we need a domain name for FQDN in /etc/hosts
## we take domain name from GLOBAL NETWORK - settings
SAMBA4_DNS_DOMAIN_NAME=${DOMAIN_NAME}
##
## REAL = DNS Domain in capital letters
SAMBA4_REALM_DOMAIN_NAME=$(echo "${SAMBA4_DNS_DOMAIN_NAME}" | tr '[:lower:]' '[:upper:]')
## Name of your NT/SAMBA Domain, should be first part of domain name
SAMBA4_DOMAIN=$(echo ${SAMBA4_DNS_DOMAIN_NAME} | awk 'BEGIN { FS = "." } { print $1 }')
## Administartor Password in cleartext
SAMBA4_ADMINISTRATOR_PASSWORD=Passw0rd



#####################################################################
## SAMBA4 ACTIV DOMAIN CONTROLLER
#####################################################################
##
## install hostname & ip with
## hostname_static-ip/install-hostname_and_static_ip.sh
##
## we use all parameters from SAMBA4 ENVIROMENT
##
## setup of a Samba4 Activ Domain Controller
## ATTENTION:
## smb - Server for home directories 
## has do be done extra on a different host
##
## we need a static ip for FQDN in /etc/hosts
## we take static IP from HOSTNAME and NETWORK - INTERFACE
##
## we need a DNS forwarder for /etc/samba/smb.conf
SAMBA4_AD_DNS_FORWARDER_IP=${DNS_IP_LOCAL_NETWORK}


#####################################################################
## SAMBA-4 FILE SERVER FOR HOMES
#####################################################################
##
## install hostname & ip with
## hostname_static-ip/install-hostname_and_static_ip.sh
##
## we use all parameters from SAMBA4 ENVIROMENT
##
## we need a seperate variable for the AD-DNS-Server for member servers
## to write right settings to /etc/resolv.conf
## so fill in static IP of your AD - Controller!
SAMBA4_AD_DNS_STATIC_IP=
##
## Path where standard dir users is created
SAMBA4_HOMES_BASE_DIR=/home


#####################################################################
## AD - CLIENT
#####################################################################
##
## ## we use all parameters from SAMBA4 ENVIROMENT
## set Parameter in /etc/sssd/sssd.conf
## to control UID Mapping
## True: (default) UID & GID are automatic generated from AD SID
## False: UID & GID are taken from rfc2307
## uidNumber & gidNumber
HAS_LDAP_ID_MAPPING=False

#####################################################################
## NEXTCLOUD / OWNCLOUD
#####################################################################
# install nextcloud / owncloud server
# splitted up in parts
# 1. sql - server
# 2. create database and admin-user for database
# 3. apache2 web-server
# 4. nextcloud/owncloud - server

#####################################################################
## SQL - Server
#####################################################################
SQL_SERVER_ROOT_PASSWORD=root1234


#####################################################################
## DATABASE & DATABASE-ADMIN 
#####################################################################
# create database user with all rights for database
DB=mycloud
DB_ADMIN=dbadmin
DB_ADMIN_PASSWORD=dbadmin1234


#####################################################################
## Apache2 - Server
#####################################################################
## nothing to config :-)


#####################################################################
## CLOUD - SERVER & CLOUD - ADMIN
#####################################################################
# please fill in latest version
NEXTCLOUD_VERSION=latest-14
# cloud admin
CLOUD_ADMIN=admin
CLOUD_ADMIN_PASSWORD=admin1234

## owncloud datapath
## LEAVE EMPTY FOR DEFAULT: /var/www/owncloud/database
## can be changed, if data should be stored elsewhere
OC_DATA_PATH=

